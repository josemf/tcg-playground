{
  "$id": "https://tennistcg.io/schema/ph4a-build-rsq.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Phase 4.1 â€” Build RSQ",
  "type": "object",
  "required": ["$prev", "$curr", "$next", "context", "players", "phase"],
  "properties": {
    "$prev": { "type": "string", "format": "uri", "const": "https://tennistcg.io/schema/ph3-select-shot.json" },
    "$curr": { "type": "string", "format": "uri", "const": "https://tennistcg.io/schema/ph4a-build-rsq.json" },
    "$next": { "type": "string", "format": "uri", "const": "https://tennistcg.io/schema/ph4b-direction-change.json" },
    "context": { "$ref": "https://tennistcg.io/schema/ph1-serve.json#/properties/context" },
    "players": { "$ref": "https://tennistcg.io/schema/ph1-serve.json#/properties/players" },
    "phase": {
      "type": "object",
      "required": ["id", "execute"],
      "properties": {
        "id": { "type": "string", "const": "ph4a-build-rsq" },
        "execute": {
          "type": "object",
          "required": ["hitterId", "dice", "skillBonus", "shotCardBonus", "baseRSQ", "staminaBoost", "shotClause", "provisionalRSQ"],
          "properties": {
            "hitterId": { "type": "string" },
            "dice": { "type": "array", "items": { "type": "integer", "minimum": 1, "maximum": 6 }, "minItems": 2, "maxItems": 2 },
            "skillBonus": { "type": "integer" },
            "shotCardBonus": { "type": "integer" },
            "baseRSQ": { "type": "integer" },
            "staminaBoost": { "type": "integer", "minimum": 0 },
            "shotClause": {
              "type": "object",
              "required": ["applied", "text"],
              "properties": {
                "applied": { "type": "boolean" },
                "text": { "type": "string" }
              }
            },
            "provisionalRSQ": { "type": "integer" }
          }
        }
      }
    }
  }
}
